<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Viewer</title>
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="js/toth-zoom-0.1.js"></script>
        <script src="js/toth-drag-0.1.js"></script>
        <script type="text/javascript">
        	
        	 var canvas, ctx, img, mouseX, mouseY, canvasW,  canvasH, imgW, imgH, canvasPosX, canvasPosY, mousePY;
        	 var resize = false;
        	 var zoom = true;
        	 var zoomRatio = 0.9;

        	$(function () {
    			canvas = $('#myCanvas')[0];    			
    			ctx = canvas.getContext('2d');  			
    			
    			img = new Image;
    			img.src = 'img/1.3.51.0.7.1465996233.36248.17230.40441.29652.7180.31075.jpg';
    			img.onload = function () {    				
					handlerCanvasResize();
    				$(window).resize(function (event) {
    					resize = true;
    					handlerCanvasResize(event);
    				});
    				$('#myCanvas').mousedown(function (event) {
    					switch (event.which) {
    						case 1:
    							break;
							case 2:
								handlerDragOn(event);
								break;
							case 3: 								
								handlerZoomOn(event);
								break;
    					}
    				});
    				$(window).mouseup(function (event) {
    					switch (event.which) {
    						case 1: 
    							break;
							case 2:
								handlerDragOff(event);
								break;
							case 3:
								handlerZoomOff(event);
								break;
    					}
    				});
    			};
        	});

        	function handlerMousePosition (event) {          		
    			mouseX = event.pageX - $('#myCanvas').offset().left;
    			mouseY = event.pageY - $('#myCanvas').offset().top;   
    			mousePY = mouseY;		
        		
        		console.log(mouseX +' | '+ mouseY);
        	}

        	function handlerCanvasResize () {  	
				canvasW = $(window).width();
				canvasH = $(window).height();

				drawImageResize();
			}			

        	function drawImageResize () {
				var imgRatio = img.width / img.height;

				if (canvasW / canvasH > imgRatio) {
					imgH = canvasH;
					imgW = imgH * imgRatio;
				} else {
					imgW = canvasW;
					imgH = imgW / imgRatio;
				}		

				if (resize) {
					ctxRatioW = $('#myCanvas').width() / imgW;
					ctxRatioH = $('#myCanvas').height() / imgH;
					$('#myCanvas').css('width',imgW +'px');
					$('#myCanvas').css('height', imgH +'px');
                    console.log(ctxRatioW +' | '+ ctxRatioH);
					ctx.scale(ctxRatioW, ctxRatioH);
				} else {
					$('#myCanvas').css('width',imgW +'px');
					$('#myCanvas').css('height', imgH +'px');
					canvas.width = imgW;
					canvas.height = imgH;
				}				

				canvasPosX = (canvasW / 2) - (imgW / 2); 
				canvasPosY = (canvasH / 2) - (imgH / 2);

				$('#myCanvas').css('top', canvasPosY);
				$('#myCanvas').css('left', canvasPosX);
	
				ctx.drawImage(img, 0, 0, imgW, imgH);    	
        	}

        	
        </script>        
    </head>
	<body>
		<canvas id="myCanvas">This browser does not support canvas element</canvas>	        
    </body>
</html>
