var zoom={on:function(a){var b=a.clientY-$(this).offset().top;var c=Math.abs(b-handler.lastY)/1000;if(handler.lastY>b){handler.zoomRatio=1.03+c}else{handler.zoomRatio=0.97-c}zoom.transformImage();handler.lastOrigin={x:handler.origin.x,y:handler.origin.y};handler.origin={x:((handler.mClickPos.x/handler.scale+handler.origin.x)-(handler.mClickPos.x/(handler.scale*handler.zoomRatio))),y:((handler.mClickPos.y/handler.scale+handler.origin.y)-(handler.mClickPos.y/(handler.scale*handler.zoomRatio)))};handler.scale*=handler.zoomRatio;handler.infoScale=handler.scale*handler.respScale;$("#infoScale").html(lang.scale+": "+handler.infoScale.toFixed(2));handler.lastY=b;handler.drawScene(handler.numImg)},transformImage:function(){handler.context.translate(handler.origin.x,handler.origin.y);handler.context.scale(handler.zoomRatio,handler.zoomRatio);handler.context.translate(-((handler.mClickPos.x/handler.scale+handler.origin.x)-(handler.mClickPos.x/(handler.scale*handler.zoomRatio))),-((handler.mClickPos.y/handler.scale+handler.origin.y)-(handler.mClickPos.y/(handler.scale*handler.zoomRatio))))},lastTransformImage:function(){handler.context.scale(handler.scale,handler.scale);handler.context.translate(-handler.origin.x,-handler.origin.y);handler.drawScene(handler.numImg)},magnifyingGlass:function(){var b=document.createElement("canvas");var a=b.getContext("2d");b.setAttribute("id","magnifyingGlass");document.getElementById("scene").appendChild(b);b.width=$("#myCanvas").width();b.height=$("#myCanvas").height();b.style.zIndex=100;b.style.position="absolute";b.style.left=0;b.style.top=0;$(window).on("resize",function(){b.width=$("#myCanvas").width();b.height=$("#myCanvas").height()});$("#scene").on("mousemove",function(d){a.clearRect(0,0,b.width,b.height);var c=d.clientX-$(this).offset().left;var e=d.clientY-$(this).offset().top;if(handler.detectBrowser.isFirefox()||handler.detectBrowser.isMSIE()){a.save();a.beginPath();a.arc(c,e,180,0,Math.PI*2,true);a.fill();a.lineWidth=10;a.strokeStyle="#d58512";a.stroke();a.closePath();a.clip();a.drawImage(handler.canvas,-c*2,-e*2,$("#myCanvas").width()*3,$("#myCanvas").height()*3);a.restore()}else{a.drawImage(handler.canvas,-c*2,-e*2,$("#myCanvas").width()*3,$("#myCanvas").height()*3);a.globalCompositeOperation="destination-atop";a.fillStyle="#fff";a.beginPath();a.arc(c,e,180,0,Math.PI*2,true);a.fill();a.lineWidth=10;a.strokeStyle="#d58512";a.stroke()}})}};