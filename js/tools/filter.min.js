var filter={pixels:null,on:function(a){var c=a.clientX-$(this).offset().left;var b=a.clientY-$(this).offset().top;handler.ba+=b-handler.mClickPos.y;handler.c+=(c-handler.mClickPos.x)/100;handler.b=1+Math.min(1000,Math.max(-150,handler.ba))/150;handler.c=Math.max(1,Math.min(handler.c,10));$("#infoBC").html(lang.brightness+": "+handler.b.toFixed(2)+" "+lang.contrast+": "+handler.c.toFixed(2));filter.pixels=handler.tempContext.getImageData(0,0,handler.tempCanvas.width,handler.tempCanvas.height);filter.brightnessContrastNegative();handler.context.putImageData(filter.pixels,0,0);handler.mClickPos.x=c;handler.mClickPos.y=b},brightnessContrastNegative:function(){var f=filter.pixels.data;var j,h;j=handler.b*handler.c;h=-handler.c*128+128;var e,d,a;for(var c=0;c<f.length;c+=4){e=f[c]*j+h;if(e>255){f[c]=255}else{if(e<0){f[c]=0}else{f[c]=e}}d=f[c+1]*j+h;if(d>255){f[c+1]=255}else{if(d<0){f[c+1]=0}else{f[c+1]=d}}a=f[c+2]*j+h;if(a>255){f[c+2]=255}else{if(a<0){f[c+2]=0}else{f[c+2]=a}}if(handler.isNegative){f[c]=255-f[c];f[c+1]=255-f[c+1];f[c+2]=255-f[c+2]}}},negative:function(){filter.pixels=handler.tempContext.getImageData(0,0,handler.tempCanvas.width,handler.tempCanvas.height);filter.brightnessContrastNegative();handler.context.putImageData(filter.pixels,0,0)},filtered:function(){filter.pixels=handler.tempContext.getImageData(0,0,handler.tempCanvas.width,handler.tempCanvas.height);filter.brightnessContrastNegative();handler.context.putImageData(filter.pixels,0,0)}};